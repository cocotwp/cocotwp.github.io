---
layout: article
title: Spark SQL
tags: 
- Spark
- 黑马
toc: true
---

## 快速入门

### 什么是 SparkSQL

Spark SQL is Spark's module for working with structured data.

*限定*：结构化数据处理

### SparkSQL 的特点

1. 融合性：SQL 可以无缝集成在代码中，随时用 SQL 处理数据
2. 统一数据访问：一套标准 API 可读写不同数据源
3. Hive 兼容：可以使用 SparkSQL 直接计算并生成 Hive 数据表
4. 标准化连接：支持标准化 JDBC\\ODBC 连接，方便和各种数据库进行数据交互

## SparkSQL 概述

### SparkSQL 和 Hive 的异同

<div align="center">
	<img src="https://raw.githubusercontent.com/cocotwp/cocotwp.github.io/master/assets/images/sparkSQL/SparkSQL和Hive的异同.png" alt="SparkSQL和Hive的异同" width="75%" />
</div>

SparkSQL 和 Hive 都是”分布式 SQL 计算引擎“

### SparkSQL 的数据抽象

| Pandas - DataFrame | SparkCore - RDD | SparkSQL - DataFrame |
| :---: | :---: | :---: |
| <font color="red">二维表数据结构</font> | 不限定标准数据结构 | <font color="red">二维表数据结构</font> |
| 本地集合 | <font color="red">分布式集合</font> | <font color="red">分布式集合</font> |

SparkSQL 其实有3类数据抽象对象：
- SchemaRDD 对象（已废弃）：引入 Schema 的 RDD
- Dataset 对象：加入泛型特性，可用于 Java、Scala 语言
- DataFrame 对象：可用于 Java、Scala、Python、R

### DataFrame 概述

DataFrame v.s. RDD：

| | DataFrame | RDD |
| --- | :---: | :---: |
| 数据结构 | 只能存储二维表结构数据 | 存储任意结构的数据 |
| 示例 | <img src="https://raw.githubusercontent.com/cocotwp/cocotwp.github.io/master/assets/images/sparkSQL/DFvsRDD1.png" alt="DFvsRDD1" height="100px" /> | <img src="https://raw.githubusercontent.com/cocotwp/cocotwp.github.io/master/assets/images/sparkSQL/DFvsRDD2.png" alt="DFvsRDD2" height="100px" /> |

### SparkSession 对象

在Spark 2.0后，推出了 `SparkSession` 对象，作为 Spark 编程的统一入口对象。

SparkSession 对象可以：
- 用于 SparkSQL 编程作为入口对象
- 用于 SparkCore 编程，可以通过 SparkSession 对象中获取到 SparkContext

